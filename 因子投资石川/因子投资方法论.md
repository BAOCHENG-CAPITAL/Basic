# 因子投资方法论

## 投资组合排序法

由1.1.2节因子的定义可知，一个因子代表了不同资产收益率的某种驱动力，而该因子的收益率就是这些资产的共性收益。然而在上述定义中，因子是十分抽象的。因子收益率是什么呢？它又如何计算呢？举例来说，股票市场的整体估值水平和股票的收益率密切相关，估值的高低能够影响股票收益率的共同涨跌。又比如，股票市场作为经济的晴雨表，股票收益率的高低又都受到宏观经济好坏（如GDP的高低）的影响。这些例子说明，像估值、GDP这些都可以作为因子来解释股票的收益率，但是如何定量计算它们的收益率呢？为了回答问题，就要用到实证资产定价和因子投资中的一个非常重要的概念——因子模拟投资组合（factor mimicking portfolio）。如果说因子是抽象的，那么因子模拟投资组合就是这个抽象概念的实际载体，它是定量研究和使用因子的出发点。

### 因子模拟投资组合

因子模拟投资组合是使用股票资产、围绕某目标因子构建的投资组合；该投资组合需满足以下两个条件：

1. 条件一：该投资组合仅在目标因子上有大于零的暴露、在其他因子上的暴露为零；
2. 条件而：在所有满足条件一的投资组合中，该投资组合的特质性风险（idiosyncratic risk）最小。

以下通过一个假想的例子逐条解读这两个条件。假设有两个因子A和B以及四支股票。表2.1给出了这些股票在这两个因子上的暴露以及它们的特质性风险。接下来按上述两个条件来构建因子A的因子模拟组合。

首先来看一个错误的做法，即按同等资金权重配置股票一和股票二。他们在因子A上的因子暴露都很高，似乎能够反映出因子A的收益率。然而，这种做法之所以错误，是因为这两支股票在因子B上的因子暴露也非常高。因此，由它们二者构成的投资组合的收益率将受到因子A和B的共同影响。这个问题就体现出满足上述定义中第一个条件的重要性；因子模拟投资组合的收益率应该仅由目标因子驱动，而不受其他因子的影响（意味着投资组合对于其他因子的因子暴露为零），这才能纯粹反映出该目标因子的收益。按照这个条件，可以选择等资金权重配置股票一和股票三。由于它们在因子B上的暴露取值相反，因此这二者构成的投资组合尽在因子A上有暴露，满足第一个条件。

上面的第一条虽然很关键，但是在它的限制下，得到的投资组合并不一定是唯一的。比如同等权重配置股票一和股票三满足第一个条件；类似的，同等权重配置股票一和股票四也满足第一个条件。那么，它们是否都可以作为因子A的因子模拟组合？还是需要进一步取舍呢？这时就要给出第二个条件——因子模拟投资组合的特质性风险最小。该组合的特质性风险由构成它的个股的特质性风险决定。对于多因子模型来说，个股的特质性风险源自个股收益率在时序上的随机扰动，即式中的ε。对于一个满足条件一的投资组合，它的收益率由两部分驱动，分别为目标因子和构成该组合的个股的特质性风险。

如果该组合中特质性风险很高，那么特质性风险的影响就会压过目标因子而占主导地位，这会给因子收益率的计算带来较大的误差。换句话说，只有尽可能地排除特质性风险的影响、使得该投资组合的收益中的绝大部分都由目标因子驱动，才能够准确地计算因子的收益率。这正是第二个条件背后的动机。因子模拟投资组合是所有满足条件一的投资组合中，特质性风险最低的。回到上面的例子，在股票一和股票三、股票一和股票四这两个组合中，由表中数据可知，后者的特质性风险要低于前者，因而满足条件二。因此，根据因子模拟组合需满足的两个条件，最终可通过等权重配置股票一和股票四构建了因子A的因子模拟投资组合。

有了因子模拟投资组合，就可以计算因子收益率了。从定义出发，因子模拟投资组合就是针对某目标因子构建的投资组合；在条件一和条件二的约束下，该投资组合的收益率应尽可能地由目标因子驱动，因此该投资组合的收益率就是因子收益率。从上面的例子也不难看出，为了构建因子模拟组合，首先需要知道资产在不同因子上的暴露。在因子暴露已知的前提下，人们可以通过不同的方法来构建因子模拟投资组合。在众多方法中，有一个简化的方法在学术界的实证资产定价研究和业界的因子投资中均得到了广泛的应用，它就是投资组合排序法（portfolio sort），简称排序法。

### 排序法及其检验

大量研究发现，股票的收益率受很多因子的影响。因性质不同，因子又可以分为不同的种类。以2.1节开篇举的两个例子来说，围绕诸如估值这类股票的财务信息或者量价数据构建的因子代表了最主流的一类因子，它们被称为股票的风格因子（style factor），典型的风格因子还包括市值、盈利、低波动等：而像围绕GDP这类经济数据构建的因子则被称为宏观经济因子。因子的种类远不止风格因子和宏观经济因子两类，上面的例子只是为了说明数据的属性决定了因子的类别。有必要指出的是，本节介绍的排序法是针对风格因子构建因子模拟投资组合的一种简化方法。对于其他类型的因子，比如宏观经济因子，该方法并不适用（2.2节会说明如何处理其他类型的因子）。话虽如此，由于风格因子在股票多因子模型中的地位无人能及，这种方法得到了广泛的使用。

前文2.1.1节的例子说明，构建因子模拟组合的前提是知道所有股票在该因子上的暴露。股票在某因子i上的暴露β反映的是在控制了其他因子后，该目标因子的收益率变化对股票超额收益变化的影响程度。这意味着首先需要知道因子收益率才能计算因子暴露。而从前文可知，首先需要有因子模拟组合才能计算因子收益率，而因子暴露又是构建因子模拟组合的前提条件。这种矛盾似乎让人们陷入了“先有鸡还是先有蛋”的怪圈。排序法最大的优势则在于它舍弃了“因子暴露已知”这个条件，从而绕过了上述“怪圈”。

下面以账面市值比（book-to-market ratio, BM, 即市净率的倒数）这个经典的估值指标为例介绍排序法。虽然BM是一个估值指标，但依照学术界的惯例，将通过它构建的因子称为价值因子而非估值因子。本书遵循上述惯例。在排序法中，将股票排序的变量（比如BM）被称为排序变量（sort variable，简称变量）。排序法中最核心的思想是使用个股在该变量上取值的大小来代替个股在该因子上暴露的高低。需要强调的是，该方法并没有假设变量的取值等于因子暴露，也没有假设这二者之间满足某种特定的数学关系。该方法仅假设变量和因子暴露是相关联的。以BM为例，该方法认为高BM的股票在围绕BM构建的价值因子上的暴露更高，低BM的股票在围绕BM构建的价值因子上的暴露更低，仅此而已。在这个核心思想下，人们虽然不知道个股在该因子上的暴露，但是却可以通过变量的高低来代替它，并以此为依据构建因子模拟投资组合。这正是排序法的方便之处。同时，这也解释了排序法为什么仅适用于风格因子。对于其他类型的因子（比如宏观经济因子），由于难以从个股本身的数据出发找到和因子暴露相关的变量，自然也就无法使用这种方法。

前面说完了排序法的核心思想，下面马上来介绍它的具体方法。排序法的英文名字是portfolio sort，它的背后包含了“按变量将股票排序”“把股票依排序分组构建投资组合”以及“定期更新投资组合”三个步骤。

1. 排序：首先确定股票池，并将股票池中的全部股票在截面上按照排序变量（本例中的BM）的取值从大到小（或从小到大）排序。
2. 分组：按排名高低将全部股票分为L组（依照惯例，一般根据变量取值分布的十分位数将全部股票分为10组，即L=10）。做多排名最高的第一组内的股票，并同时做空排名最低的最后一组内的股票而构建一个多、空对冲的投资组合，该投资组合又被成为价差组合（spread portfolio）。由构建方式可知，价差组合中多、空两头的收益率分别为变量取值最高的1/L股票的收益率和变量取值最低的1/L股票的收益，它们的差异就反映了围绕该变量构建的因子的收益率。因此，价差组合正是使用排序法构建的因子模拟投资组合，而价差组合的收益率正式该因子的收益率。需要指出的是，在构建价差组合时，通常要求多、空两个投资组合都包含多支股票，因子需要为它们选择个股加权方式，其中最常见的是市值加权和等权重。
3. 定期更新：由于个股在变量上的取值并非一成不变的（即代表它们在该因子上的暴露也是随时间变化的），因此需要定期进行上述两步，完成对因子模拟投资组合的更新。学术界通常称上述更新为再平衡（rebalance），且再平衡的频率多为每月或每年。在每期构建了新的因子模拟投资组合之后，计算该组合在当前时刻和下一个再平衡时刻之间的收益率。在时序上如此往复，就得到因子收益率的时间序列。

通过排序法，人们可以方便地构建因子模拟投资组合，计算因子收益率以及由排序法得到的L个投资组合的收益率。一旦有了这些数据，检验因子预期收益率，以及考察L个投资组合收益率的单调性就构成了检验的内容。学术界将上述检验成为投资组合排序检验（portfolio sort test）。下面一次说明这两个检验内容。

投资组合排序检验最重要的目的是检验因子预期收益率。在关于因子的研究中，原假设通常为因子预期收益为零。由第1章的定义可知，因子的预期收益率应该大于零。因此，检验关注的是依据样本数据计算出的因子收益率，能否在给定的显著性水平下拒绝原假设。

除此之外，由于一个好的因子应能够解释个股超额收益的截面差异，因此排序法关注的第二个问题就是依照排序变量高低得到的L个投资组合的收益率是否有很好的单调性，这可以通过计算收益率和排序变量分组的秩相关系数（rank correlation coefficient）来检验。秩相关系数和相关系数类似，不同的是计算时将观测值转换为观测值的排位（rank），因此它考察的是两个随机变量之间的单调相关性。统计学中有多种计算秩相关系数的方法，其中最流行的要数Spearman秩相关系数（以Charles Spearman命名）。

下面仍以BM为例对上述检验进行说明。通过排序法将A股市场中的股票按照BM高低分为L=10组（记为Low,2,...,9,High，其中Low代表BM最低的一组、High代表BM最高的一组），每组股票按总市值加权配置，每月再平衡。此外，通过做多BM最高的一组、做空BM最低的一组构建价值因子投资组合。表2.2给出了对价值因子预期收益率的检验结果，以及这10个投资组合预期收益率的检验结果（这是学术界的常见做法）。

接下来，为了从视觉上更好地呈现单调性，图2.1展示了利用BM排序得到的10个投资组合的月均收益率，它们基本随BM的增加而变大。这10个投资组合的收益率和BM分组的秩相关系数高达0.94，表现出显著的单调性，且收益率和BM取值之间呈正相关。

由于简单易用，排序法在学术界和业界关于风格因子的研究中得到了广泛的应用。值得一提的是，在前文介绍排序法的时候默认的都是使用单一变量对股票排序，因此它也被称为单变量排序（univariate sorting）。但不要忘记，排序法仅仅是构建因子模拟投资组合的一个相对“粗暴”的方法。根据定义，因子模拟投资组合应该在非目标因子上没有暴露，然而排序法却难以控制其他因子的影响，这是它最大的缺点。举个假想的例子，如果高BM的股票全是大市值股票、低BM的股票全都是小市值股票，那么当使用BM这个单一变量排序的时候，构建的价差组合在无形之中也同时做多了大市值股票、做空了小市值股票。因此，这个价差组合虽然围绕BM构建的，但其收益率却受到了BM和市值的共同影响，因而难以客观评估BM的贡献，为了尽可能排除其他因子的干扰，常见的做法是使用多个变量进行双重排序或三重排序，这些方法统称为多重排序法。

### 多重排序法

1. 双重排序

   在多重排序中，最重要的是双重排序（double sorting 或 bivariate sorting）。所谓双重排序，即按照两个变量排序并构建因子模拟投资组合。考虑两个排序变量X1和X2，将股票按照这两个变量分别划分为L1和L2组，一共得到L1xL2个组合。在双重排序时，一处非常关键的细节是使用这两个变量分别独立对股票排序，还是这两个变量在排序时存在先后的依存关系。前者被成为独立双重排序（independent double sorting或unconditional double sorting），或者被成为条件双重排序（dependent double sorting或conditional double sorting）。

   首先来看独立双重排序的情况。假设使用两个排序变量分别独立地把股票划分为5组，即L1=L2=5，它们两两取交集一共得到了25个投资组合，如图2.2中的P11到P55所示。在划分时，最常见的做法是取这两个变量各自的五分位数。这25个投资组合中股票的权重可以采用等权重或市值加权。接下来，通过这25个组合就可以围绕给定的变量构建因子模拟投资组合了。以X1为例，构建的思路和单变量排序一样，仍然是做多在该变量上排名高的股票、做空在该变量上排名低的股票，并满足资金中性。由于采用了双重排序，因此对于变量X2的每一档，都存在一个在变量X1上排名高的投资组合。换句话说，一共

2. 两点说明

   关于双重排序，还有两点补充说明。第一点说明，使用双重排序的目的是排除两个变量之间的相互影响，从而更准确地计算围绕每个变量构建的因子模拟投资组合的收益率。在这方面，条件双重排序比独立双重排序是更好的选择，因为它是在控制了第一个分类变量后、考察第二个分类变量和股票收益率的条件关系。然而，学术界在研究因子时，往往更习惯使用独立双重排序。这可能与最初经典的Fama and French三因子模型使用了独立排序有关。另外，当研究异象时，为了排除小市值的影响，使用市值和异象变量进行条件双重排序、构建异象投资组合并计算其超额收益率也并不罕见。而在这些研究中，两种计算收益率的方法均有使用。举例来说，Bali et al.在研究尾部风险异象时采用计算异象收益率；而Liu,Stambaugh and Yuan则使用研究并计算了一些列异象投资组合的收益率。

   第二点说明是关于双重排序时两个变量划分的分组数。当学术界研究异象时，当股票池中的股票数量很大时，5x5或10x10都是常见的分组方式。但是当学术界研究因子时往往采用2x3的划分，且变量之一是股票的市值。这种处理方法也和Fama and French三因子模型不无关系。由于该文是多因子模型的开山鼻祖，它的很多处理方法对学术界都有着非常深远的影响。Fama and French在构建规模（SMB）和价值（HML）两个因子时，采用市值和BM进行独立双重排序。在排序时，该文按市值把股票分成了大、小市值两组，按BM把股票分成高、中、低三组，最后两两交集构建了6个投资组合。这种使用市值和另外一个变量进行2x3划分的独立双重排序在Fama and French之后得到了广泛的应用，本书第四章会详细介绍。

3. 三重排序

   除前面介绍的双重排序外，今年也有部分研究采用了三重排序（triple sorting）。一个典型的例子是Hou et al.提出的四因子模型。该文从实体投资经济学理论出发推导出预期收益率和投资以及盈利之间的条件关系。此外，考虑到盈利能力和投资效应在小盘股中都更强，为了排除市值的影响，Hou et al.在构建因子时，使用规模、投资和盈利三个维度的变量进行了三重排序。

   排序法及其检验是因子研究中最常见的方法之一。它最大的好处是绕过因子暴露，构建因子模拟投资组合、计算因子收益率。它是通过时间序列回归检验股票多因子模型的基础。

### 因子命名约定

因子命名本身并无严格的要求。但之所以需要约定一个命名方式，是因为无论是在学术界的研究还是业界的实践中，对同一个因子往往有很多不同的称呼。仍以BM为例。在Fama and French三因子模型中，两位作者使用BM和市值双重排序构建了一个HML因子。HML是High-Minus-Low的首字母缩写，而其中High代表BM高的股票，Low代表BM低的股票，Minus代表做多前者、做空后者。显然，人们也可以把它称作BM因子——这个名字以构建因子的变量为出发点；又或者把它成为价值因子——这个名字以该变量代表的股票风格（style）为出发点。无论是叫HML因子、BM因子还是价值因子，它们指代的是同一个因子模拟投资组合、同一个因子。为了本书前后一致性，本小节对书中使用的因子命名方法进行说明。在因子命名时，考虑的因素是命名的方便程度以及名字是否能清晰地传达因子的含义。

首先，本书不采用Fama and French的命名方法，原因如下。任何一个变量排序都可以把股票分成高、中、低不同的分组，并构建一个High-Minus-Low组合。如果大家都叫HML因子，则无法加以区分。举例来说，在Fama and French五因子模型中包括使用BM构建的HML因子和使用ROE构建的盈利因子。Fama and French将ROE和市值一起进行双重排序，并通过做多高ROE的组同时做空低ROE的组构建了该盈利因子。由于Hight和Low两个词已经被HML因子占用了，Fama and French则想出了稳健和疲软来代表高、低两个ROE组合，并以Robust-Minus-Weak即RMW为该因子命名。这种做法的优点是，它能体现变量和收益率之间是正相关还是负相关。比如无论是HML还是RMW，都代表变量高取值组和变量低取值组的差异，这意味着BM或ROE和股票收益率呈现正相关。而在Fama and French中，代表规模的SMB因子是Small-Minus-Big的缩写，它则表示市值和收益率呈现负相关，即小市值股票的预期收益率高于大市值股票。尽管有这一优点，然而一旦人们真正理解了因子背后的原因，就不再需要依靠其命名来暗示变量和收益率的关系。且考虑到这种做法在因子数量越来越多的时候将会对因子命名造成不便，因此本书放弃这种方法。

使用变量本身和使用代表的风格命名在方便程度上并无太大差异，但由于以下两个原因，本书作者认为后者更合理。首先，如前所述，风格因子在股票市场中占主宰地位。学术界和业界的绝大多数研究都是关于风格因子。因此，风格比变量本身能更清晰地传达出因子所代表地含义。其次，在业界的因子投资实践中，处于稳健性的考虑，往往使用多个指标构建某种风格的因子。比如，业界会同时使用BM和盈利市值比（earnings-to-price ratio，即EP）等多个估值指标构建价值因子。在这种情况下，选择某个指标对因子命名就会以偏概全。

处于上述考量，本书选择以变量代表的风格为出发点对因子进行命名。举例来说，按照本书的约定，将会称使用BM构建的因子为价值因子，使用ROE构建的因子为盈利因子。

## 多因子模型的回归检验

使用2.1节介绍的排序法，人们可以很容易地针对股票风格因子构建因子投资组合计算其收益率。然而，多因子模型中最核心地问题是检验一系列因子检验异象的能力。本节就来说明如何使用回归的方法检验多因子模型，其中涉及的不同方法包括时序回归检验，截面回归检验以及Fama and MacBeth回归检验。

在下文的介绍中，令N和K分别代表资产和因子的个数。

再来细品一品这句话，即多因子模型研究的是资产预期收益率在截面上的差异。站在本书提出的统一视角下，这是从截面角度来研究多因子模型的。在检验模型时，不关心资产的收益率R在时间序列上是如何随着每期因子收益率来波动的，只关心R的期望ER在截面上和对应的β之间的关系，因为模型是关于均值的模型。多因子模型中所包含的因子代表了收益率的一种结构。一旦结构给定后，个股或者任何一个投资组合的预期收益率就完全由它在这些因子上的暴露决定了——暴露高，预期收益率就高；预期收益率是因子暴露的线性函数。怎样找到最好的银子结构，即那些因子是的个股在截面上的预期收益率区分度高，并让不能被该模型解释的定价误差α部分尽可能低，就是多因子模型研究的问题。

仍然晦涩？用图2.3解释以下（因为要做图，所以假设单因子模型）。图中横坐标为β，纵坐标为ER，每个点代表一个资产，途中这条直线就代表ER=βλ，它的斜率λ就是因子的预期收益率。当模型不能被完美地满足时，资产的预期收益率ER和模型算出的βλ之间就会存在误差，它就是图中的α。

正如前文反复强调的，多因子模型反映的是预期收益率和因子暴露在截面上的关系。在多因子模型被提出之前，人们最熟悉的因子模型无疑是CAPM。它因为只有一个市场因子，所以是多因子模型的一个特例。人们最早的猜测是市场因子的收益率和个股在该因子上的β就可以解释截面上不同股票收益率之间的区别。但大量的实证结果显示如果把个股的ER和它们针对市场因子的β画出来，二者之间的关系并不能很好地满足该模型，说明仅仅用单一市场因子无法很好地解释ER在截面上的差别。为了反映这一现象，Black et al.在CAPM的基础上又加入了一个zero-beta因子，该两因子模型能够更好地解释ER在界面上的差别。再后来，Fama and French 提出了大名鼎鼎地三因子模型，它在市场因子的基础上加入价值（HML）和规模（SMB）两个因子。这些努力都是为了能够更好地解释人们在股票收益率数据中观察到的ER在截面上的差别。

之所以回顾上面这一小段历史，是为了说明学术界在多因子模型上的各种努力都是为了更好地解释ER为什么会因资产而异。那么，拿来一个多因子模型，如何定量地评估它是否是一个好的模型呢？为了回答这个问题，首先来看检验中的三个部分：估计值（estimate）、标准误差（standard errors）以及检验（test）。

对于截面关系式E=α+βλ，下文将采用回归分析（regression analysis）来确定参数。一旦有了估计值和标准误差，就可以用它们来检验多因子模型。由式2.12可知，α代表了资产i的定价误差。如果能够在统计上证明所有α都很接近零，则可以说该多因子模型就是很好的模型，即它能够解释资产预期收益率的界面差异。由此可见，多因子模型的回归检验中最重要的就是检验所有α联合起来是否在统计上足够接近零。出自之外，使用λ的估计值和标准误差，同样可以检验每个因子的预期收益率。根据上述说明，多因子模型的回归检验可以简单总结为以下三步：

1. 计算每个资产在所有因子上的暴露β
2. 通过回归分析对多因子模型进行估计
3. 联合检验资产定价误差α以及每个因子的预期收益率λ

无论选择哪些因子（诸如风格因子或宏观经济因子），也无论在确定截面关系时采用时序回归还是截面回归，对多因子模型的检验最终都可以按照上述三步完成。下面先来看看时间序列回归检验。

### 时间序列回归

时间序列回归（time-series regression）简单直接，Black et al.最早使用它来检验CAPM。这种方法在回归时使用因子收益率作为自变量independent variable或解释变量explanatory variable 以资产的超额收益率作为因变量dependent variable 或被解释变量 explained variable。

此方法更适合分析由风格因子构成的多因子模型，这是因为人们可以使用2.1节介绍的排序法构建风格因子的因子模拟投资组合，并计算其收益率作为解释变量。对于其他类别的因子，比如GDP等宏观经济因子，由于难以应用排序法构建它的因子模拟投资组合以及计算收益率，所以这种方法就无法使用，举例来说，Fama and French中的价值HML和规模SMB因子均是风格因子。该文使用独立双重排序构建了这两个因子的投资组合，并计算了它们的收益率时间序列，使用它们就可以方便地进行时间序列回归检验。

### 截面回归

时间序列回归虽然很方便，但它以因子收益率时序已知为前提。这意味着它更适合处理股票的风格因子，而对诸如GDP、CPI以及利率这样的宏观经济因子无能为力。这时可以选择截面回归（cross-sectional regression）来检验多因子模型，它能够方便地处理因子收益率时序未知地情况。截面回归检验的最终目的自然还是考察ER和β在截面上的关系，但此方法的第一步仍然是利用时序回归确定资产的因子暴露。

### 时序回归vs截面回归

2.2.1和2.2.2两节分别介绍了时序回归和截面回归。有意思的是，对于风格因子这种可以通过排序法构建银子模拟投资组合并计算因子收益率时序的情况，既可以使用时序回归又可以使用截面回归来检验多因子模型。那么它们二者的区别是什么呢？

图2.6以单因子为例，直观地比较了二者的区别。时序回归仅在时序上对每个资产进行回归，然后通过在时序上取均值来得到隐含的截面关系。这意味着图2.6中时序回归得到的ER=βλ必然经过远点和1，λ两点（其中λ时因子收益率的时序均值）。反观截面回归，它的第一步和时序回归完全一样，也是使用已有的因子收益率作为解释变量，得到资产的因子暴露估计β。然而在第二步，它没有采用”时序上取平均“，而是以β为解释变量，以ER为被解释变量进行截面回归。以OLS为例，它以最小化所有资产定价误差α的平方和为目的。

在时序回归中，每个资产的定价误差的股价α来自独立的回归，即每个资产进行一次回归，一共进行N次，得到全部N个α；而在截面回归中，它第二部的截面回归以最小化N个α的平方和为目标，因此它同时利用了所有资产的数据。从某种意义上来说，这使得截面回归更加合理。对于时序回归，因子的平均收益率就是该因子模拟投资组合收益率在全部T期的均值；而对于截面回归，因子的平均收益率就是该因子模拟投资组合收益率在全部T期的均值；而对于截面回归来说，因子收益率通过OLS和GLS确定，它的取值将会和时序回归得到的因子收益率不同。这是二者最大的区别。

看到这里，有的读者朋友也许会问一个问题。对于风格因子，它们的因子模拟投资组合明明已经有了，因子收益率时间序列也有了，只需要通过在时序上取平均就可以得到因子预期收益率，而截面回归却进行了第二步，通过OLS或GLS得到因子预期收益率。这两种方法得到的因子收益率是不同的，那么它们之间有什么差异？到底那个是更准取的呢？

### Fama-MacBeth回归

1973年，Eugene Fama和James MacBeth在Fama and MacBeth一文中提出了一个两步回归方法（被称为Fama-MacBeth回归），该文的目的是检验CAPM。该方法非常巧妙地派出了随机扰动在截面上的相关性对标准误的影响，在业界被广泛使用。这篇文章也是计量经济学领域被引用最频繁的文章之一。

### 不同回归方法比较

前文2.2.1节、2.2.2节以及2.2.4节分别介绍了时序回归、截面回归和Fama-MacBeth回归三种检验多因子模型的回归方法。对于这些方法，在本书作者平日阅读学术论文和自身研究因子时有两点体会，在此分享给读者。

首先，所有模型都是”不完美“的。这句话的意思是，当把足够多的资产放在回归模型的左侧时，任何一个多因子模型都会被拒绝（即若资产定价误差联合起来为零，则被拒绝）。人们研究多因子模型的动机不应追求它们在统计上多么”完美“，而应关注每个因子背后到底有多少逻辑。在实证资产定价的研究中，往往不会使用个股作为资产取检验模型（否则模型一定会被拒绝），而是依据一些规则把股票”打包“成投资组合，然后使用这些投资组合作资产去检验多因子模型。这是学术界最常见的做法。

其次，在检验多因子模型时，不同的方法在很大程度上可以说都是”殊途同归“，它们之间的差异也许都没有它们名字的差异大；在特定的假设下，不同的方法往往是等价的，比如，当因子暴露β在时序上不变时，那么传统截面回归和Fama-MacBeth截面回归的结果时一致的。在应用中，可以通过比较不同检验方法的结果来加深对多因子模型的认知，这才是学习不同方法最大的价值。

## 因子暴露和因子收益率

### 引入工具变量

### 使用公司特征

### 两类模型

## 异象检验

### 时序回归检验异象

### 计量经济学问题

### White估计量和Newey-West估计量

### 截面回归检验异象

## 多因子模型比较

### GRS检验

### 均值-方差张成检验

### 从几何角度比较GRS和均值-方差张成

### α检验

### 贝叶斯方法

## 因子正交化

### 简单一元回归

### 回归的几何意义

### 用正交化过程求解多元回归

## 广义矩估计

### 样本均值的方差

### 分析框架

### 数学基础

### 有效性

### 不应成为黑箱

## 研究方法建议