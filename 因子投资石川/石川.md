# 因子投资基础

因子投资涵盖的内容包罗万象。有人用因子来获取收益，也有人用因子来控制风险；有人用因子进行被动的资产配置，也有人用因子博取主动的套利收益；有人用因子研究预期收益率，也有人用因子研究收益率的波动……这些差异性的使用方式足以把刚接触因子投资的人搞得晕头转向。而如果将“什么是因子投资”这个问题抛给从事因子投资的人，一千个人也可能给出一千种答案。因子投资涉及的内容虽然看似纷繁，但它们其实非常协调地构成了一个有机的整体。本书将围绕一个公式，站在一个统一的视角下探讨因子投资的方方面面。

# 因子投资方法论

本章介绍学术界在进行实证资产定价研究时最常用的方法。熟悉并掌握它们有两个作用。首先，在金融学、经济学、会计学的顶级期刊，一级投资业界的最高水平期刊上，大量关于实证资产定价和因子投资的文章均会使用这些方法。掌握它们有助于读懂最新的论文，获得研究因子的新思路。其次，很多方法（例如投资组合排序法和Fama-MacBeth回归）在业界的因子研究中得到了广泛的应用。

本章内容共分为8节，把因子投资方法论中的各知识点按照严谨的先后顺序有机地串联在一起。为了帮助读者更好地学习本章内容，以下首先简要说明本章的结构，每节的开头则会进一步解释上下文的关联。本章的2.1节首先介绍如何使用排序法构建因子模拟组合并进行检验，它是一切的基础。无论是研究多因子模型还是异象，都需要用到它。接下来的2.2节是本章的核心，说明如何使用不同的回归方法对多因子模型进行检验。2.3节将进一步对因子暴露和因子收益率检验进行解读。因子投资中的一个重要内容是通过异象获取多因子模型无法解释的超额收益，本章的2.4节就来讨论这个问题。2.5节解读比较不同多因子模型的方法，它一直是学术界研究的热点。本章的2.6和2.7两节内容相对独立。2.6节说明因子正交化的重要性 。在业界进行因子投资时，因子正交化是十分常见的处理方式。2.7节介绍广义矩估计。掌握这个非常强大的计量经济学工具将为今后持续展开因子投研工作打下坚实的基础。最后，2.8节对全章内容进行总结，给出因子投资中使用这些方法的建议。

在正式介绍不同的方法之前，先来说说本章的写作风格。本章的内容将不可避免地涉及大量的数学公式。然而，本书的目标并不是成为纯理论的“数学”书，因此行文不会变成定理或者证明的罗列。美国金融协会前主席、实证资产定价领域的顶尖学者John Cochrane教授曾说“在现实和学术中，金融中的数学其实并不难。难的是理解如何使用这些方程，以及它们对这个世界的真正意义。”本书作者十分认可上述观点，因此本书在介绍数学公式和推导时会遵循以下两个目标：（1）尽量阐述数学背后的直观含义，帮助读者在实际因子研究中应用这些方法。对于第一点，行文中会加入必要的图示，通过可视化解释公式的含义；对于第二点，行文中会抠一些看似不那么重要的细节，比如矩阵和向量的阶数。希望本章的内容既能够让读者暂时跳出细节，直观上理解公式的全貌，又能为读者提供足够的细节，从而在研究和实践因子投资中运用它们。本着这两个目标，文中涉及的数学会力争严谨，但也会做到“点到而止”。对某个方法感兴趣的读者，可以进一步学习相关章节给出的参考文献。

# 主流因子解读

除介绍因子投资的方法论之外，本书的另一个特色是针对A股进行严谨的、可复制的实证分析。这些实证分析分布于本章、第4章及第5章，分别以因子、多因子模型和异象为研究对象，使用第2章介绍的相关方法进行深度实证分析。

然而，巧妇难为无米之炊，要做好实证分析，离不开高质量的原始数据，也离不开严谨的数据处理流程。在因子投资中，数据处理方面存在很多坑。无论是未来数据的迷雾，还是不切实际的设定，都可能让人在兴高采烈后落入无尽的空虚。因此在针对A股进行实证研究之前，首先要把数据和计算因子的流程说清楚。本章的3.1节会系统地介绍这部分内容，包括数据来源、财务数据处理、量价数据处理和历史回溯的基本约定等。全书中所有的实证的数据处理都将遵循3.1节介绍的方法。

在介绍完数据处理方法后，3.2节到3.8节将以A股为研究对象，深度解读学术界认可的主流因子，包括市场因子、价值因子、动量因子、盈利因子、投资因子和换手率因子。除换手率因子外，其余因子均被包含在海外学术界最重要的多因子模型中，并得到了业界的广泛认可。把每个因子背后的来龙去脉讲清楚将有助于读者理解本书第4章介绍的这些多因子模型。虽然换手率因子尚未被纳入海外的模型中，但由于其在A股市场的显著性和认可度，本章也将其加入讨论之列。

在以下针对每个因子的论述中会同时关注因子的起源和成因。知前者能了解因子的发展演进，知后者则可以明白每个因子为什么会有显著的超额收益。长久以来，风险补偿都是解释因子溢价的另一个思路。因此在讨论因子成因时，会涉及部分行为金融学的内容。为了行文的紧凑，本章暂时不会对行为金融学进行展开论述，但6.3节将系统地阐述行为金融学和资产预期收益率之间的关系，供读者参考。在介绍完起源和成因之后，本书将对因子进行基于A股市场的深度实证。

# 多因子模型

本章首先梳理学术界主流的多因子模型，为读者进行相关的研究提供思路。值得一提的是，这些多因子模型均是针对美国股票市场提出的。这背后的原因有二：第一，在全球所有股票市场中，美国股市当仁不让是最重要的。第二，现代金融学诞生于以芝加哥大学、麻省理工学院及哈佛大学等为代表的美国顶尖学府，因而学术界以美股为研究对象也就顺理成章。不过可喜的是，多因子模型经过多年的发展和完善，很多学者也把其中一些模型应用于其他国家的股票市场中，并取得了令人满意的实证结果。

本章的第4.2节使用Fama-MacBeth回归分析研究了A股中哪些因子被定价。待检验的因子正是本书第3章涉及的因子。第3章的实证结果显示诸如价值、规模这些因子在A股上都是显著的。但是由于排序法无法完全剔除因子间的相互影响，因此造成目标因子在其他因子上不可避免地暴露，从而影响实证结果。第4.2节的Fama-MacBeth回归分析能够规避这一问题，给出更稳健的因子收益率分析结果。

接下来，第4.3节将通过一个例子说明如何使用常见的统计学手段，如GRS检验和α检验，比较不同的多因子模型。为了使结果对A股的因子投资更具参考价值，参与比较的多因子模型之一是近年来备受关注的中国版三因子模型，而参与比较的另一个多因子模型则是本书作者从公司估值角度推导出的四因子模型。值得一提的是，本节讨论的重点是比较模型方法论的应用，而非是在两个模型中决出高低。

本章最后一节讨论咋i构建多因子模型时应遵循的简约性原则。研究表明，多因子模型解释资产预期收益率的能力和其复杂度呈正相关。从实证研究的角度，当多因子模型中加入越来越多的因子后，它总能更好地解释资产或异象的收益率，然而这么做却意义不大。优秀的多因子模型通常只应包含少量有限个因子，且每个因子背后都应该有明确的金融学或经济学含义。

# 异象研究

继第3章和第4章在A股市场对因子和多因子模型进行了实证之后，本章是本书实证环节的第三部分，它将着眼于分析异象。从因子投资的方法论来说，如果一个资产能够获得定价模型无法解释的超额收益，那么它就可以被称为一个异象。然而，由于人们对真实定价模型的认知还非常有限，因此通过数据挖掘总能找到很多源自公司财务信息或者量价信息的指标，以它们为变量构建的投资组合便符合上述异象的定义。然而在现实中，很多异象仅仅是过拟合的产物，在样本外根本站不住脚。为了避免这个问题，异象背后应该有非常扎实的金融学依据。

此外，由式（1.3）可知，异象的超额收益代表了异象的预期收益和定价模型所解释的预期收益之间的偏离。从这个意义上说，异象的产生和投资者对资产的错误定价有关。因此，越来越多在样本外可持续的异象都能或多或少地从错误定价的角度解释。另一方面，与早期使用单一变量构建异象的研究相比，越来越多新近的研究使用多变量，从多维度构建综合异象变量，从而捕捉更加稳定的超额收益。本章接下来的部分将详细解释三个经典异象，它们分别由预期差造成的估值高低异象、基本面锚定反转异象以及特质性波动率之谜。希望通过本章的介绍让各位读者了解研究异象的方法。

在开始解读异象之前，还有一个问题需要说明。为了检验异象能否获得显著超额收益率，就必须要选择定价模型。为此，本章的实证选取了被海外学术界和业界最广泛使用的CAPM和Fama-French三因子模型。此外，由本书第4.3节的论述可知，Liu,Shi and Lian主张的包含市场、规模、价值以及盈利的四因子模型也能解释很多A股市场上的潜在异象。细心的读者可能已经发现，该模型其实就是在Fama-French三因子模型的基础上加入了Fama-French提出的盈利因子，是对三因子模型的完美补充。为此，本章也将上述四因子模型（记为Liu-Shi-Lian四因子模型）选为用于检验异象的定价模型。除上述模型外，Fama-French五因子模型也是海外学术界常用的定价模型。然而，从本书3.7.3节的实证结果可知，投资因子在A股上并不显著，无法解释股票预期收益率的截面差异。此外，从计量经济学的角度来说，投资因子可以被视为一个不相关的变量（irrelevant variable）。在OLS中加入不相关变量虽然不会影响其他估计量的无偏性，但会对估计量的方差造成负面的影响，进而影响检验结果。基于以上两点原因，本章并未将Fama-French五因子模型选为定价模型之一。

本章分别依照4.1.1和4.3.3节的说明构建Fama-French三因子模型和Liu-Shi-Lian四因子模型。为了使实证更加符合A股市场，在构造因子时采用了时效性更高的季报数据，而非像Fama and French一样针对美股采用的年报数据，且采用每月再平衡的方式更新因子收益率。本书的配套网站对每个因子的具体构造方法进行了详细说明，并提供因子收益率时间序列数据，感兴趣的读者可下载使用，书中对此不再赘述。最后，本章的实证将同时采用等权重和市值加权来构建和异象有关的投资组合。

# 因子研究现状

本章分为8节，主要介绍学术界关于因子投资的最新研究进展和趋势。首先，6.1节解读一个近几年十分流行的概念，即“因子动物园”。它旨在讽刺学术界在发表偏差的影响下挖掘出的数百个因子，其中绝大部分仅仅是过拟合的产物。为此由很多学者站出来呼吁改变这种风气。接下来6.2节将话题从“因子动物园”转移到“因子大战”。它表达了这样一种担忧，即学者们提出不同的多因子模型，到底是为了看谁能在样本内解释更多的异象，还是谁更能加深人们对于股票市场的理解，后者才是正确和负责任的研究态度。

长久以来，投资者普遍认为因子代表了某种系统性风险。而行为金融学的发展为解释因子和异象提供了另一个重要角度，而它也越来越被人们接受。6.3节会解读行为金融学的研究框架以及它与异象和因子的关系。6.4节的标题是投资者情绪，它与6.3节密切相关。投资者情绪被认为是造成市场中大量错误定价的原因之一。它是行为金融学的重要研究对象，并且和诸多异象的表现有着紧密的关联。

在学术界和业界研究股票收益率的截面差异时，发现了数百个在样本内能够获得显著超额收益的异象。而这背后的原因可能是风险补偿或是错误定价，也有可能仅仅是数据窥探在样本外的表现。人们研究因子是为了在投资实践中使用它们，而样本内能够获得显著受益的因子往往到了样本外马上”见光死“，6.6节讨论这背后的原因。

6.7节讨论因子投资和基本面分析的关系。在因子投资中，从财务数据中挖掘出基本面因子占了很大的比重。基本面信息加因子投资也逐渐形成了一个全新的投资概念——基本面量化投资。但是，以因子投资为工具的基本面量化投资能否代替古老的基本面分析呢？6.7节会给出答案。

本章最后一节的标题为机器学习和因子投资。近年来，随着数据的激增和技术的革新，机器学习为金融领域带来了崭新的发展契机。然而，机器学习能在哪些维度上和因子投资相结合？机器学习中的非线性模型能否战胜传统的线性多因子模型呢？这是6.8节要探讨的内容。

# 因子投资实践

本章共分为8节，从不同角度系统地解读业界的因子投资实践，为读者更好地进行因子投资打下坚实地基础。其中7.1节、7.2节和7.3节将分别从收益率模型、风险模型和投资组合优化三个部分阐述主动管理中如何利用多因子模型作为一个量化工具（quantitative tool）来获取超过基准地收益。这三部分是所有关于因子投资材料的必备内容。本章的亮点包括以下几方面。

7.1节首先通过对术语的解读，阐明了业界常挂在口边的”阿尔法因子“和学术界的多因子模型式（1.3）之间的关系。在此基础上，对如何筛选优秀的预测变量进行了系统的说明。7.2节的内容关注风险模型。除了在界面上预测预期收益率，多因子模型的另一个作用是在时序上研究股票收益率的波动，并通过降维方便地求出股票地协方差矩阵。这部分内容以著名的Barra模型为例，成体系地阐述如何构建一个优秀的风险因子模型，从而在事前准确地预测股票收益率地协方差矩阵。接下来，7.3节将目光转向投资组合优化。业界无论是公募还是私募、无论是买方还是卖方，各家都有自有收益模型，而对于风险模型则一般使用现成的商业模型。由于收益模型和风险模型中的因子不同，造成了两个模型之间的错位。如果不加处理，那么这种错位将导致投资组合优化给出错误的结果。关于错位问题，海外业界在近年来提出了很多修正方法，然而却尚未得到国内的重视。本节的介绍将填补这方面的空白。除此之外，7.3节还将说明不同目标函数之间的等价条件，让读者在选择不同的目标函数时能够有据可依。

7.4节将非常细致地介绍因子指数和Smart Beta投资的相关内容。如果说将多因子模型视作量化工具是主动管理人获取超额收益的法宝，那么Smart Beta的普及毫无疑问是普通投资者享受因子投资盛宴的利器。因为无论是通过复杂数学模型和优化得到最优的投资组合，还是仅仅通过排序法透明、低成本地复制因子投资组合，其本质都是利用了因子预测股票收益率的能力。学术界几十年来关于因子和异象的研究为Smart Beta的蓬勃发展奠定了坚实的基础。

接下来的7.5节将介绍一个”烫手的山芋“——因子择时。进行因子投资，因子择时是一个绕不开的话题。但大量基于实证数据的研究表明，样本外因子择时成功（即战胜等权重配置）的难度都非常高。因此，本节的目标并非不切实际地告诉读者某种择时的“独门绝技”，而是把研究因子择时的体系娓娓道来，供读者参考。

除了获取更高收益或控制风险外，多因子模型的另一个重要作用就是分析主动投资的业绩表现。在多因子模型普及之前，这个任务似乎无法可依，然而多因子模型的出现让它迎刃而解。7.6节和7.7节将分别以风格分析和风险归因为研究对象，说明如何使用多因子模型对主动投资业绩的收益率和风险进行归因，这有助于投资者了解和掌握一支基金的投资风格和风险控制水平。

本章的最后一节是对因子投资的展望，包括两部分内容。7.8.1节将介绍近年来非常火的一个概念：另类数据。随着量价和财务数据被过度使用，很多因子的表现越来越不尽如人意。这使得人们将目光转向了潜在的新的收益源，即另类数据。然而另类数据真的像人们想象的那样是一片蓝海、“即插即用”吗？本节将会给出讨论的思考。最后7.8.2节将介绍如何使用因子进行大类资产配置。随着对因子和资产关系理解的加深。业界现已普遍认为不同大类的资产（例如股票、债券、商品、外汇、房地产等）的收益率背后都是由底层的一些公共因子所驱动的。因此多因子模型的研究可以被完美地应用于打雷资产的配置中，并从资产配置思维转变到因子配置思维。这就是7.8.2节要讨论的问题。

