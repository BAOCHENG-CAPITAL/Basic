第十七章 模型构建流程

数据获取

特征和标签提取

特征预处理

样本内训练

样本外测试

模型评价

获取数据：A股所有股票，沪深300，中证500等股票池。

特征和标签提取：计算88个因子作为样本特征；按月计算个股收益，收益率前30%的标注为1，后30%为-1.

特征预处理：进行缺失值处理；去掉特征异常的股票，比如某个特征值高于99.5%或低于0.5%的；标准化处理，去除特征量纲/数量级差异的影响，行业是指中性化处理。

模型训练与预测 导入sklearn机器学习包，使用机器学习算法进行模型训练和预测 尝试多种参数，核函数

策略回测 利用2016到2018年数据进行训练，预测2019到2022年的股票表现。每个周期等权重买入预测值为1的股票，持有到下个换股周期。

模型评价：查看模型回测结果；对比不同参数，核函数的策略结果。

案例：沪深300指数增强模型

1. 在每个月的月末对因子数据进行提取，因此需要对每个月的月末日期进行统计。本文选取开始日期为2016.5.1结束日期为2022.2.28
2. 可选股票池HS300 ZZ500 中证800 创业板指以及全A股 股票筛选：剔除ST股票 剔除上市3个月内的股票 每只股票视作一个样本以HS300为例 取2019-01-01当天的股票成分股。
3. 特征提取 每个自然月的最后一个交易日，计算之前课程里的90个因子暴露度作为样本的原始特征。特征预处理：
   1. 中位数去极值
   2. 缺失值处理
   3. 行业市值中性化
   4. 标准化
4. 需要将收益率数据转化为标签，在每个月末截面期，选取下月收益排前30%的股票分别作为正例。为了对模型进行测试，需要对数据集进行分割，故将前2016年5月1-

选择一种机器学习算法，将训练集数据和标签带入



